# Tf-Idf с использованием Spark DataFrame API

### Dataset:
Trip Advisor Hotel Reviews ![link](https://www.kaggle.com/andrewmvd/trip-advisor-hotel-reviews)

### Top 100 most frequent words (example)

    +--------+---------+---------+--------------------+------------------+--------------------+
    |    Word|TermCount|DocsCount|                  Tf|               Idf|               TfIdf|
    +--------+---------+---------+--------------------+------------------+--------------------+
    |   hotel|    49814|    16400| 0.02235112635067407| 4.672769000441461| 0.10444165033638006|
    |    room|    35331|    14202| 0.01585272503905861| 4.816658099123442| 0.07635715645255864|
    |     not|    31709|    12155|0.014227563846579758| 4.972288433967886| 0.07074355115788818|
    |   great|    21475|    11127|0.009635653398256025| 5.060646854401291|0.048762639059985464|
    |       t|    19527|     8597|0.008761602044598157| 5.318581690948343|0.046599296217775324|
    |       n|    19104|     8430|0.008571805472422962| 5.338195920081894| 0.04575797700062391|
    |    good|    17412|     9402|0.007812619183722185| 5.229082521727493| 0.04085283042251459|
    |   staff|    16633|    11768|0.007463088380591035| 5.004642353126908|  0.0373500881946352|
    |    stay|    15411|    10192|0.006914787172084918| 5.148410098836157|  0.0356001601080647|
    |     did|    14006|     7251| 0.00628437538980088| 5.488834016129828|0.034493893409668214|
    |    just|    12667|     7767|0.005683577257076092| 5.420098578033409|0.030805549009221146|
    |    nice|    12643|     7499|0.005672808657236365|5.4552082884801685|0.030946352805917874|
    |   rooms|    12401|     8532|0.005564225275519...| 5.326170309467985| 0.02963601145766122|
    |      no|    11846|     6896|0.005315201404225419| 5.539024774573279| 0.02944103225985128|
    |location|    11351|     8362|0.005093099032531042| 5.346294094623044| 0.02722920528095105|
    |  stayed|    10500|     8569|0.004711262429880711|5.3218435764127445| 0.02507260169925536|
    | service|    10367|     6380|0.004651586439102222| 5.616786484136223|  0.0261269678409407|
    |   night|    10151|     6689|0.004554669040544676| 5.569497434882296| 0.02536721753805138|
    |    time|    10120|     6283|0.004540759599085028| 5.632104588629058|0.025574032973868233|
    |   beach|    10061|     3972|0.004514286791145699| 6.090589832189971|0.027494669229741482|
    +--------+---------+---------+--------------------+------------------+--------------------+
    
### Pivot reviews by 100 most frequent words (example)

    +-----+--------------------+-------------------+-------------------+-------------------+--------------------+
    |DocID|               great|              hotel|                not|               room|                   t|
    +-----+--------------------+-------------------+-------------------+-------------------+--------------------+
    |  474|0.048762639059985464|0.10444165033638006|               null|0.07635715645255864|                null|
    | 1697|                null|0.10444165033638006|0.07074355115788818|0.07635715645255864|                null|
    | 4590|                null|0.10444165033638006|0.07074355115788818|0.07635715645255864|0.046599296217775324|
    | 5409|0.048762639059985464|0.10444165033638006|0.07074355115788818|               null|                null|
    | 2529|0.048762639059985464|               null|0.07074355115788818|0.07635715645255864|0.046599296217775324|
    | 2453|0.048762639059985464|0.10444165033638006|0.07074355115788818|0.07635715645255864|0.046599296217775324|
    | 2040|0.048762639059985464|0.10444165033638006|0.07074355115788818|0.07635715645255864|                null|
    | 3091|0.048762639059985464|0.10444165033638006|0.07074355115788818|0.07635715645255864|                null|
    | 2250|0.048762639059985464|0.10444165033638006|0.07074355115788818|               null|0.046599296217775324|
    | 2214|                null|0.10444165033638006|               null|0.07635715645255864|0.046599296217775324|
    | 3506|                null|0.10444165033638006|               null|               null|                null|
    | 2927|0.048762639059985464|0.10444165033638006|0.07074355115788818|0.07635715645255864|0.046599296217775324|
    | 2509|0.048762639059985464|0.10444165033638006|               null|               null|0.046599296217775324|
    | 3764|0.048762639059985464|               null|0.07074355115788818|0.07635715645255864|0.046599296217775324|
    | 5385|0.048762639059985464|0.10444165033638006|0.07074355115788818|               null|                null|
    | 1806|0.048762639059985464|0.10444165033638006|0.07074355115788818|               null|                null|
    |   29|                null|0.10444165033638006|0.07074355115788818|               null|                null|
    | 1677|                null|0.10444165033638006|0.07074355115788818|0.07635715645255864|                null|
    | 4894|0.048762639059985464|0.10444165033638006|               null|0.07635715645255864|                null|
    |  964|                null|0.10444165033638006|               null|0.07635715645255864|                null|
    +-----+--------------------+-------------------+-------------------+-------------------+--------------------+
